package com.google.android.gms.internal.ads;

import android.app.AlertDialog;
import android.content.Context;
import android.content.res.Resources;
import android.net.Uri;
import android.text.TextUtils;
import android.webkit.URLUtil;
import com.google.android.gms.ads.impl.R;
import com.google.android.gms.ads.internal.zzbv;
import java.util.Map;

@zzadh
public final class zzaae extends zzaal {
  private final Context mContext;
  
  private final Map<String, String> zzbgp;
  
  public zzaae(zzaqw paramzzaqw, Map<String, String> paramMap) {
    super(paramzzaqw, "storePicture");
    this.zzbgp = paramMap;
    this.mContext = paramzzaqw.zzto();
  }
  
  public final void execute() {
    String str1;
    if (this.mContext == null) {
      zzbw("Activity context is not available");
      return;
    } 
    if (!zzbv.zzek().zzao(this.mContext).zziy()) {
      zzbw("Feature is not supported by the device.");
      return;
    } 
    String str2 = (String)this.zzbgp.get("iurl");
    if (TextUtils.isEmpty(str2)) {
      zzbw("Image url cannot be empty.");
      return;
    } 
    if (!URLUtil.isValidUrl(str2)) {
      str1 = String.valueOf(str2);
      if (str1.length() != 0) {
        str1 = "Invalid image url: ".concat(str1);
      } else {
        str1 = new String("Invalid image url: ");
      } 
      zzbw(str1);
      return;
    } 
    String str3 = Uri.parse(str2).getLastPathSegment();
    if (!zzbv.zzek().zzcw(str3)) {
      str1 = String.valueOf(str3);
      if (str1.length() != 0) {
        str1 = "Image type not recognized: ".concat(str1);
      } else {
        str1 = new String("Image type not recognized: ");
      } 
      zzbw(str1);
      return;
    } 
    Resources resources = zzbv.zzeo().getResources();
    AlertDialog.Builder builder = zzbv.zzek().zzan(this.mContext);
    if (resources != null) {
      str1 = resources.getString(R.string.s1);
    } else {
      str1 = "Save image";
    } 
    builder.setTitle(str1);
    if (resources != null) {
      str1 = resources.getString(R.string.s2);
    } else {
      str1 = "Allow Ad to store image in Picture gallery?";
    } 
    builder.setMessage(str1);
    if (resources != null) {
      str1 = resources.getString(R.string.s3);
    } else {
      str1 = "Accept";
    } 
    builder.setPositiveButton(str1, new zzaaf(this, str2, str3));
    if (resources != null) {
      str1 = resources.getString(R.string.s4);
    } else {
      str1 = "Decline";
    } 
    builder.setNegativeButton(str1, new zzaag(this));
    builder.create().show();
  }
}

package com.google.android.gms.internal.ads;

import java.security.GeneralSecurityException;
import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.spec.GCMParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public final class zzayj implements zzatz {
  private final SecretKey zzdna;
  
  public zzayj(byte[] paramArrayOfByte) { this.zzdna = new SecretKeySpec(paramArrayOfByte, "AES"); }
  
  public final byte[] zzc(byte[] paramArrayOfByte1, byte[] paramArrayOfByte2) throws GeneralSecurityException {
    if (paramArrayOfByte1.length <= 2147483619) {
      byte[] arrayOfByte3 = new byte[paramArrayOfByte1.length + 12 + 16];
      byte[] arrayOfByte2 = zzazl.zzbh(12);
      System.arraycopy(arrayOfByte2, 0, arrayOfByte3, 0, 12);
      Cipher cipher = (Cipher)zzayy.zzdnz.zzek("AES/GCM/NoPadding");
      GCMParameterSpec gCMParameterSpec = new GCMParameterSpec(128, arrayOfByte2);
      cipher.init(1, this.zzdna, gCMParameterSpec);
      byte[] arrayOfByte1 = paramArrayOfByte2;
      if (paramArrayOfByte2 == null)
        arrayOfByte1 = new byte[0]; 
      cipher.updateAAD(arrayOfByte1);
      cipher.doFinal(paramArrayOfByte1, 0, paramArrayOfByte1.length, arrayOfByte3, 12);
      return arrayOfByte3;
    } 
    throw new GeneralSecurityException("plaintext too long");
  }
}

package com.google.android.gms.stats;

import android.annotation.SuppressLint;
import android.content.Context;
import android.os.PowerManager;
import android.os.WorkSource;
import android.support.annotation.NonNull;
import android.support.annotation.Nullable;
import android.text.TextUtils;
import android.util.Log;
import com.google.android.gms.common.annotation.KeepForSdk;
import com.google.android.gms.common.internal.Preconditions;
import com.google.android.gms.common.internal.ShowFirstParty;
import com.google.android.gms.common.providers.PooledExecutorsProvider;
import com.google.android.gms.common.util.Strings;
import com.google.android.gms.common.util.WorkSourceUtil;
import java.util.Collections;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.Future;
import java.util.concurrent.ScheduledExecutorService;
import java.util.concurrent.atomic.AtomicInteger;
import javax.annotation.concurrent.ThreadSafe;

@KeepForSdk
@ShowFirstParty
@ThreadSafe
public class WakeLock {
  private static ScheduledExecutorService zzn;
  
  private final Object zza = this;
  
  private final PowerManager.WakeLock zzb;
  
  private WorkSource zzc;
  
  private final int zzd;
  
  private final String zze;
  
  private final String zzf;
  
  private final String zzg;
  
  private final Context zzh;
  
  private boolean zzi = true;
  
  private final Map<String, Integer[]> zzj = new HashMap();
  
  private final Set<Future<?>> zzk = Collections.synchronizedSet(new HashSet());
  
  private int zzl;
  
  private AtomicInteger zzm = new AtomicInteger(0);
  
  @KeepForSdk
  public WakeLock(@NonNull Context paramContext, int paramInt, @NonNull String paramString) { this(paramContext, paramInt, paramString, null, str); }
  
  private WakeLock(@NonNull Context paramContext, int paramInt, @NonNull String paramString1, @Nullable String paramString2, @NonNull String paramString3) { this(paramContext, paramInt, paramString1, null, paramString3, null); }
  
  @SuppressLint({"UnwrappedWakeLock"})
  private WakeLock(@NonNull Context paramContext, int paramInt, @NonNull String paramString1, @Nullable String paramString2, @NonNull String paramString3, @Nullable String paramString4) {
    Preconditions.checkNotNull(paramContext, "WakeLock: context must not be null");
    Preconditions.checkNotEmpty(paramString1, "WakeLock: wakeLockName must not be empty");
    this.zzd = paramInt;
    this.zzf = null;
    this.zzg = null;
    this.zzh = paramContext.getApplicationContext();
    if (!"com.google.android.gms".equals(paramContext.getPackageName())) {
      paramString2 = String.valueOf(paramString1);
      if (paramString2.length() != 0) {
        paramString2 = "*gcore*:".concat(paramString2);
      } else {
        paramString2 = new String("*gcore*:");
      } 
      this.zze = paramString2;
    } else {
      this.zze = paramString1;
    } 
    this.zzb = ((PowerManager)paramContext.getSystemService("power")).newWakeLock(paramInt, paramString1);
    if (WorkSourceUtil.hasWorkSourcePermission(paramContext)) {
      paramString1 = paramString3;
      if (Strings.isEmptyOrWhitespace(paramString3))
        paramString1 = paramContext.getPackageName(); 
      this.zzc = WorkSourceUtil.fromPackage(paramContext, paramString1);
      workSource = this.zzc;
      if (workSource != null && WorkSourceUtil.hasWorkSourcePermission(this.zzh)) {
        WorkSource workSource1 = this.zzc;
        if (workSource1 != null) {
          workSource1.add(workSource);
        } else {
          this.zzc = workSource;
        } 
        workSource = this.zzc;
        try {
          this.zzb.setWorkSource(workSource);
        } catch (IllegalArgumentException workSource) {
          Log.wtf("WakeLock", workSource.toString());
        } catch (ArrayIndexOutOfBoundsException workSource) {}
      } 
    } 
    if (zzn == null)
      zzn = PooledExecutorsProvider.getInstance().newSingleThreadScheduledExecutor(); 
  }
  
  private final String zza(String paramString) { return this.zzi ? (!TextUtils.isEmpty(paramString) ? paramString : this.zzf) : this.zzf; }
  
  private final List<String> zza() { return WorkSourceUtil.getNames(this.zzc); }
  
  private final void zza(int paramInt) {
    if (this.zzb.isHeld()) {
      try {
        this.zzb.release();
      } catch (RuntimeException runtimeException) {
        if (runtimeException.getClass().equals(RuntimeException.class)) {
          Log.e("WakeLock", String.valueOf(this.zze).concat(" was already released!"), runtimeException);
        } else {
          throw runtimeException;
        } 
      } 
      this.zzb.isHeld();
      return;
    } 
  }
  
  @KeepForSdk
  public void acquire(long paramLong) { // Byte code:
    //   0: aload_0
    //   1: getfield zzm : Ljava/util/concurrent/atomic/AtomicInteger;
    //   4: invokevirtual incrementAndGet : ()I
    //   7: pop
    //   8: aload_0
    //   9: aconst_null
    //   10: invokespecial zza : (Ljava/lang/String;)Ljava/lang/String;
    //   13: astore #6
    //   15: aload_0
    //   16: getfield zza : Ljava/lang/Object;
    //   19: astore #5
    //   21: aload #5
    //   23: monitorenter
    //   24: aload_0
    //   25: getfield zzj : Ljava/util/Map;
    //   28: invokeinterface isEmpty : ()Z
    //   33: istore #4
    //   35: iconst_0
    //   36: istore_3
    //   37: iload #4
    //   39: ifeq -> 49
    //   42: aload_0
    //   43: getfield zzl : I
    //   46: ifle -> 73
    //   49: aload_0
    //   50: getfield zzb : Landroid/os/PowerManager$WakeLock;
    //   53: invokevirtual isHeld : ()Z
    //   56: ifne -> 73
    //   59: aload_0
    //   60: getfield zzj : Ljava/util/Map;
    //   63: invokeinterface clear : ()V
    //   68: aload_0
    //   69: iconst_0
    //   70: putfield zzl : I
    //   73: aload_0
    //   74: getfield zzi : Z
    //   77: ifeq -> 148
    //   80: aload_0
    //   81: getfield zzj : Ljava/util/Map;
    //   84: aload #6
    //   86: invokeinterface get : (Ljava/lang/Object;)Ljava/lang/Object;
    //   91: checkcast [Ljava/lang/Integer;
    //   94: astore #7
    //   96: aload #7
    //   98: ifnonnull -> 129
    //   101: aload_0
    //   102: getfield zzj : Ljava/util/Map;
    //   105: aload #6
    //   107: iconst_1
    //   108: anewarray java/lang/Integer
    //   111: dup
    //   112: iconst_0
    //   113: iconst_1
    //   114: invokestatic valueOf : (I)Ljava/lang/Integer;
    //   117: aastore
    //   118: invokeinterface put : (Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;
    //   123: pop
    //   124: iconst_1
    //   125: istore_3
    //   126: goto -> 255
    //   129: aload #7
    //   131: iconst_0
    //   132: aload #7
    //   134: iconst_0
    //   135: aaload
    //   136: invokevirtual intValue : ()I
    //   139: iconst_1
    //   140: iadd
    //   141: invokestatic valueOf : (I)Ljava/lang/Integer;
    //   144: aastore
    //   145: goto -> 255
    //   148: aload_0
    //   149: getfield zzi : Z
    //   152: ifne -> 209
    //   155: aload_0
    //   156: getfield zzl : I
    //   159: ifne -> 209
    //   162: invokestatic getInstance : ()Lcom/google/android/gms/common/stats/WakeLockTracker;
    //   165: aload_0
    //   166: getfield zzh : Landroid/content/Context;
    //   169: aload_0
    //   170: getfield zzb : Landroid/os/PowerManager$WakeLock;
    //   173: aload #6
    //   175: invokestatic getEventKey : (Landroid/os/PowerManager$WakeLock;Ljava/lang/String;)Ljava/lang/String;
    //   178: bipush #7
    //   180: aload_0
    //   181: getfield zze : Ljava/lang/String;
    //   184: aload #6
    //   186: aconst_null
    //   187: aload_0
    //   188: getfield zzd : I
    //   191: aload_0
    //   192: invokespecial zza : ()Ljava/util/List;
    //   195: lload_1
    //   196: invokevirtual registerEvent : (Landroid/content/Context;Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;ILjava/util/List;J)V
    //   199: aload_0
    //   200: aload_0
    //   201: getfield zzl : I
    //   204: iconst_1
    //   205: iadd
    //   206: putfield zzl : I
    //   209: aload #5
    //   211: monitorexit
    //   212: aload_0
    //   213: getfield zzb : Landroid/os/PowerManager$WakeLock;
    //   216: invokevirtual acquire : ()V
    //   219: lload_1
    //   220: lconst_0
    //   221: lcmp
    //   222: ifle -> 246
    //   225: getstatic com/google/android/gms/stats/WakeLock.zzn : Ljava/util/concurrent/ScheduledExecutorService;
    //   228: new com/google/android/gms/stats/zzb
    //   231: dup
    //   232: aload_0
    //   233: invokespecial <init> : (Lcom/google/android/gms/stats/WakeLock;)V
    //   236: lload_1
    //   237: getstatic java/util/concurrent/TimeUnit.MILLISECONDS : Ljava/util/concurrent/TimeUnit;
    //   240: invokeinterface schedule : (Ljava/lang/Runnable;JLjava/util/concurrent/TimeUnit;)Ljava/util/concurrent/ScheduledFuture;
    //   245: pop
    //   246: return
    //   247: astore #6
    //   249: aload #5
    //   251: monitorexit
    //   252: aload #6
    //   254: athrow
    //   255: iload_3
    //   256: ifne -> 162
    //   259: goto -> 148
    // Exception table:
    //   from	to	target	type
    //   24	35	247	finally
    //   42	49	247	finally
    //   49	73	247	finally
    //   73	96	247	finally
    //   101	124	247	finally
    //   129	145	247	finally
    //   148	162	247	finally
    //   162	209	247	finally
    //   209	212	247	finally
    //   249	252	247	finally }
  
  @KeepForSdk
  public boolean isHeld() { return this.zzb.isHeld(); }
  
  @KeepForSdk
  public void release() { // Byte code:
    //   0: aload_0
    //   1: getfield zzm : Ljava/util/concurrent/atomic/AtomicInteger;
    //   4: invokevirtual decrementAndGet : ()I
    //   7: ifge -> 29
    //   10: ldc 'WakeLock'
    //   12: aload_0
    //   13: getfield zze : Ljava/lang/String;
    //   16: invokestatic valueOf : (Ljava/lang/Object;)Ljava/lang/String;
    //   19: ldc_w ' release without a matched acquire!'
    //   22: invokevirtual concat : (Ljava/lang/String;)Ljava/lang/String;
    //   25: invokestatic e : (Ljava/lang/String;Ljava/lang/String;)I
    //   28: pop
    //   29: aload_0
    //   30: aconst_null
    //   31: invokespecial zza : (Ljava/lang/String;)Ljava/lang/String;
    //   34: astore_3
    //   35: aload_0
    //   36: getfield zza : Ljava/lang/Object;
    //   39: astore_2
    //   40: aload_2
    //   41: monitorenter
    //   42: aload_0
    //   43: getfield zzi : Z
    //   46: ifeq -> 118
    //   49: aload_0
    //   50: getfield zzj : Ljava/util/Map;
    //   53: aload_3
    //   54: invokeinterface get : (Ljava/lang/Object;)Ljava/lang/Object;
    //   59: checkcast [Ljava/lang/Integer;
    //   62: astore #4
    //   64: aload #4
    //   66: ifnonnull -> 72
    //   69: goto -> 196
    //   72: aload #4
    //   74: iconst_0
    //   75: aaload
    //   76: invokevirtual intValue : ()I
    //   79: iconst_1
    //   80: if_icmpne -> 99
    //   83: aload_0
    //   84: getfield zzj : Ljava/util/Map;
    //   87: aload_3
    //   88: invokeinterface remove : (Ljava/lang/Object;)Ljava/lang/Object;
    //   93: pop
    //   94: iconst_1
    //   95: istore_1
    //   96: goto -> 198
    //   99: aload #4
    //   101: iconst_0
    //   102: aload #4
    //   104: iconst_0
    //   105: aaload
    //   106: invokevirtual intValue : ()I
    //   109: iconst_1
    //   110: isub
    //   111: invokestatic valueOf : (I)Ljava/lang/Integer;
    //   114: aastore
    //   115: goto -> 196
    //   118: aload_0
    //   119: getfield zzi : Z
    //   122: ifne -> 177
    //   125: aload_0
    //   126: getfield zzl : I
    //   129: iconst_1
    //   130: if_icmpne -> 177
    //   133: invokestatic getInstance : ()Lcom/google/android/gms/common/stats/WakeLockTracker;
    //   136: aload_0
    //   137: getfield zzh : Landroid/content/Context;
    //   140: aload_0
    //   141: getfield zzb : Landroid/os/PowerManager$WakeLock;
    //   144: aload_3
    //   145: invokestatic getEventKey : (Landroid/os/PowerManager$WakeLock;Ljava/lang/String;)Ljava/lang/String;
    //   148: bipush #8
    //   150: aload_0
    //   151: getfield zze : Ljava/lang/String;
    //   154: aload_3
    //   155: aconst_null
    //   156: aload_0
    //   157: getfield zzd : I
    //   160: aload_0
    //   161: invokespecial zza : ()Ljava/util/List;
    //   164: invokevirtual registerEvent : (Landroid/content/Context;Ljava/lang/String;ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;ILjava/util/List;)V
    //   167: aload_0
    //   168: aload_0
    //   169: getfield zzl : I
    //   172: iconst_1
    //   173: isub
    //   174: putfield zzl : I
    //   177: aload_2
    //   178: monitorexit
    //   179: aload_0
    //   180: iconst_0
    //   181: invokespecial zza : (I)V
    //   184: return
    //   185: astore_3
    //   186: aload_2
    //   187: monitorexit
    //   188: goto -> 193
    //   191: aload_3
    //   192: athrow
    //   193: goto -> 191
    //   196: iconst_0
    //   197: istore_1
    //   198: iload_1
    //   199: ifne -> 133
    //   202: goto -> 118
    // Exception table:
    //   from	to	target	type
    //   42	64	185	finally
    //   72	94	185	finally
    //   99	115	185	finally
    //   118	133	185	finally
    //   133	177	185	finally
    //   177	179	185	finally
    //   186	188	185	finally }
  
  @KeepForSdk
  public void setReferenceCounted(boolean paramBoolean) {
    this.zzb.setReferenceCounted(paramBoolean);
    this.zzi = paramBoolean;
  }
}

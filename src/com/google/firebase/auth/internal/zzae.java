package com.google.firebase.auth.internal;

import android.app.Application;
import android.content.Context;
import android.support.annotation.NonNull;
import com.google.android.gms.common.api.internal.BackgroundDetector;
import com.google.android.gms.common.util.VisibleForTesting;
import com.google.android.gms.internal.firebase_auth.zzcz;
import com.google.firebase.FirebaseApp;

public final class zzae implements FirebaseApp.IdTokenListenersCountChangedListener {
  private final zzs zzsa;
  
  @VisibleForTesting
  private zzae(@NonNull Context paramContext, @NonNull zzs paramzzs) {
    this.zzsa = paramzzs;
    BackgroundDetector.initialize((Application)paramContext.getApplicationContext());
    BackgroundDetector.getInstance().addListener(new zzaf(this));
  }
  
  public zzae(@NonNull FirebaseApp paramFirebaseApp) { this(paramFirebaseApp.getApplicationContext(), new zzs(paramFirebaseApp)); }
  
  private final boolean zzep() { return (this.zzry + this.zzrz > 0 && !this.zzsb); }
  
  public final void cancel() { this.zzsa.cancel(); }
  
  public final void onListenerCountChanged(int paramInt) {
    if (paramInt > 0 && this.zzry == 0 && this.zzrz == 0) {
      this.zzry = paramInt;
      if (zzep())
        this.zzsa.zzeh(); 
    } else if (paramInt == 0 && this.zzry != 0 && this.zzrz == 0) {
      this.zzsa.cancel();
    } 
    this.zzry = paramInt;
  }
  
  public final void zzc(@NonNull zzcz paramzzcz) {
    if (paramzzcz == null)
      return; 
    long l2 = paramzzcz.zzs();
    long l1 = l2;
    if (l2 <= 0L)
      l1 = 3600L; 
    l2 = paramzzcz.zzdy();
    zzs zzs1 = this.zzsa;
    zzs1.zzrc = l2 + l1 * 1000L;
    zzs1.zzrd = -1L;
    if (zzep())
      this.zzsa.zzeh(); 
  }
  
  public final void zzf(int paramInt) {
    if (paramInt > 0 && this.zzrz == 0 && this.zzry == 0) {
      this.zzrz = paramInt;
      if (zzep())
        this.zzsa.zzeh(); 
    } else if (paramInt == 0 && this.zzrz != 0 && this.zzry == 0) {
      this.zzsa.cancel();
    } 
    this.zzrz = paramInt;
  }
}

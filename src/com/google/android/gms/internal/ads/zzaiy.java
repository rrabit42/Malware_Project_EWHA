package com.google.android.gms.internal.ads;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.support.annotation.Nullable;
import com.google.android.gms.common.util.VisibleForTesting;
import java.lang.reflect.Method;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.ConcurrentMap;
import java.util.concurrent.Future;
import java.util.concurrent.LinkedBlockingQueue;
import java.util.concurrent.ThreadPoolExecutor;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.atomic.AtomicBoolean;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.concurrent.atomic.AtomicReference;
import javax.annotation.concurrent.GuardedBy;

@zzadh
public final class zzaiy {
  private final AtomicReference<ThreadPoolExecutor> zzcnp = new AtomicReference(null);
  
  private final Object zzcnq = new Object();
  
  @Nullable
  @GuardedBy("mGmpAppIdLock")
  private String zzcnr = null;
  
  @VisibleForTesting
  private final AtomicBoolean zzcns = new AtomicBoolean(false);
  
  @VisibleForTesting
  private final AtomicInteger zzcnt = new AtomicInteger(-1);
  
  private final AtomicReference<Object> zzcnu = new AtomicReference(null);
  
  private final AtomicReference<Object> zzcnv = new AtomicReference(null);
  
  private ConcurrentMap<String, Method> zzcnw = new ConcurrentHashMap(9);
  
  private static Bundle zza(Context paramContext, String paramString, boolean paramBoolean) {
    Bundle bundle = new Bundle();
    try {
      bundle.putLong("_aeid", Long.parseLong(paramString));
    } catch (NullPointerException paramContext) {
      paramString = String.valueOf(paramString);
      if (paramString.length() != 0) {
        paramString = "Invalid event ID: ".concat(paramString);
      } else {
        paramString = new String("Invalid event ID: ");
      } 
      zzakb.zzb(paramString, paramContext);
    } catch (NumberFormatException paramContext) {}
    if (paramBoolean)
      bundle.putInt("_r", 1); 
    return bundle;
  }
  
  private final Object zza(String paramString, Context paramContext) {
    if (!zza(paramContext, "com.google.android.gms.measurement.AppMeasurement", this.zzcnu, true))
      return null; 
    method = zzi(paramContext, paramString);
    try {
      return method.invoke(this.zzcnu.get(), new Object[0]);
    } catch (Exception method) {
      zza(method, paramString, true);
      return null;
    } 
  }
  
  private final void zza(Context paramContext, String paramString, Bundle paramBundle) {
    if (zzs(paramContext)) {
      if (!zza(paramContext, "com.google.android.gms.measurement.AppMeasurement", this.zzcnu, true))
        return; 
      method = zzac(paramContext);
      try {
        method.invoke(this.zzcnu.get(), new Object[] { "am", paramString, paramBundle });
        return;
      } catch (Exception method) {
        zza(method, "logEventInternal", true);
      } 
    } 
  }
  
  private final void zza(Exception paramException, String paramString, boolean paramBoolean) {
    if (!this.zzcns.get()) {
      StringBuilder stringBuilder = new StringBuilder(String.valueOf(paramString).length() + 30);
      stringBuilder.append("Invoke Firebase method ");
      stringBuilder.append(paramString);
      stringBuilder.append(" error.");
      zzakb.zzdk(stringBuilder.toString());
      if (paramBoolean) {
        zzakb.zzdk("The Google Mobile Ads SDK will not integrate with Firebase. Admob/Firebase integration requires the latest Firebase SDK jar, but Firebase SDK is either missing or out of date");
        this.zzcns.set(true);
      } 
    } 
  }
  
  private final boolean zza(Context paramContext, String paramString, AtomicReference<Object> paramAtomicReference, boolean paramBoolean) {
    if (paramAtomicReference.get() == null)
      try {
        paramAtomicReference.compareAndSet(null, paramContext.getClassLoader().loadClass(paramString).getDeclaredMethod("getInstance", new Class[] { Context.class }).invoke(null, new Object[] { paramContext }));
        return true;
      } catch (Exception paramContext) {
        zza(paramContext, "getInstance", paramBoolean);
        return false;
      }  
    return true;
  }
  
  private final Method zzac(Context paramContext) {
    Method method = (Method)this.zzcnw.get("logEventInternal");
    if (method != null)
      return method; 
    try {
      Method method1 = paramContext.getClassLoader().loadClass("com.google.android.gms.measurement.AppMeasurement").getDeclaredMethod("logEventInternal", new Class[] { String.class, String.class, Bundle.class });
      this.zzcnw.put("logEventInternal", method1);
      return method1;
    } catch (Exception paramContext) {
      zza(paramContext, "logEventInternal", true);
      return null;
    } 
  }
  
  private final void zzb(Context paramContext, String paramString1, String paramString2) {
    if (!zza(paramContext, "com.google.android.gms.measurement.AppMeasurement", this.zzcnu, true))
      return; 
    method = zzh(paramContext, paramString2);
    try {
      method.invoke(this.zzcnu.get(), new Object[] { paramString1 });
      StringBuilder stringBuilder = new StringBuilder(String.valueOf(paramString2).length() + 37 + String.valueOf(paramString1).length());
      stringBuilder.append("Invoke Firebase method ");
      stringBuilder.append(paramString2);
      stringBuilder.append(", Ad Unit Id: ");
      stringBuilder.append(paramString1);
      zzakb.v(stringBuilder.toString());
      return;
    } catch (Exception method) {
      zza(method, paramString2, false);
      return;
    } 
  }
  
  private final Method zzh(Context paramContext, String paramString) {
    Method method = (Method)this.zzcnw.get(paramString);
    if (method != null)
      return method; 
    try {
      Method method1 = paramContext.getClassLoader().loadClass("com.google.android.gms.measurement.AppMeasurement").getDeclaredMethod(paramString, new Class[] { String.class });
      this.zzcnw.put(paramString, method1);
      return method1;
    } catch (Exception paramContext) {
      zza(paramContext, paramString, false);
      return null;
    } 
  }
  
  private final Method zzi(Context paramContext, String paramString) {
    Method method = (Method)this.zzcnw.get(paramString);
    if (method != null)
      return method; 
    try {
      Method method1 = paramContext.getClassLoader().loadClass("com.google.android.gms.measurement.AppMeasurement").getDeclaredMethod(paramString, new Class[0]);
      this.zzcnw.put(paramString, method1);
      return method1;
    } catch (Exception paramContext) {
      zza(paramContext, paramString, false);
      return null;
    } 
  }
  
  private final Method zzj(Context paramContext, String paramString) {
    Method method = (Method)this.zzcnw.get(paramString);
    if (method != null)
      return method; 
    try {
      Method method1 = paramContext.getClassLoader().loadClass("com.google.firebase.analytics.FirebaseAnalytics").getDeclaredMethod(paramString, new Class[] { Activity.class, String.class, String.class });
      this.zzcnw.put(paramString, method1);
      return method1;
    } catch (Exception paramContext) {
      zza(paramContext, paramString, false);
      return null;
    } 
  }
  
  public final void zza(Context paramContext, String paramString1, String paramString2) {
    if (!zzs(paramContext))
      return; 
    zza(paramContext, paramString1, zza(paramContext, paramString2, "_ac".equals(paramString1)));
  }
  
  public final void zza(Context paramContext, String paramString1, String paramString2, String paramString3, int paramInt) {
    if (!zzs(paramContext))
      return; 
    Bundle bundle = zza(paramContext, paramString1, false);
    bundle.putString("_ai", paramString2);
    bundle.putString("type", paramString3);
    bundle.putInt("value", paramInt);
    zza(paramContext, "_ar", bundle);
    StringBuilder stringBuilder = new StringBuilder(String.valueOf(paramString3).length() + 75);
    stringBuilder.append("Log a Firebase reward video event, reward type: ");
    stringBuilder.append(paramString3);
    stringBuilder.append(", reward value: ");
    stringBuilder.append(paramInt);
    zzakb.v(stringBuilder.toString());
  }
  
  @Nullable
  public final String zzaa(Context paramContext) {
    if (!zzs(paramContext))
      return null; 
    zzna = zznk.zzaxt;
    long l = ((Long)zzkb.zzik().zzd(zzna)).longValue();
    if (l < 0L)
      return (String)zza("getAppInstanceId", paramContext); 
    if (this.zzcnp.get() == null) {
      AtomicReference atomicReference = this.zzcnp;
      zzna zzna1 = zznk.zzaxu;
      int i = ((Integer)zzkb.zzik().zzd(zzna1)).intValue();
      zzna1 = zznk.zzaxu;
      atomicReference.compareAndSet(null, new ThreadPoolExecutor(i, ((Integer)zzkb.zzik().zzd(zzna1)).intValue(), 1L, TimeUnit.MINUTES, new LinkedBlockingQueue(), new zzaja(this)));
    } 
    Future future = ((ThreadPoolExecutor)this.zzcnp.get()).submit(new zzaiz(this, paramContext));
    try {
      return (String)future.get(l, TimeUnit.MILLISECONDS);
    } catch (Exception zzna) {
      future.cancel(true);
      return (zzna instanceof java.util.concurrent.TimeoutException) ? "TIME_OUT" : null;
    } 
  }
  
  @Nullable
  public final String zzab(Context paramContext) {
    if (!zzs(paramContext))
      return null; 
    Object object = zza("generateEventId", paramContext);
    return (object != null) ? object.toString() : null;
  }
  
  public final void zzb(Context paramContext, String paramString) {
    if (!zzs(paramContext))
      return; 
    zzb(paramContext, paramString, "beginAdUnitExposure");
  }
  
  public final void zzc(Context paramContext, String paramString) {
    if (!zzs(paramContext))
      return; 
    zzb(paramContext, paramString, "endAdUnitExposure");
  }
  
  public final void zzd(Context paramContext, String paramString) {
    if (!zzs(paramContext))
      return; 
    if (!(paramContext instanceof Activity))
      return; 
    if (!zza(paramContext, "com.google.firebase.analytics.FirebaseAnalytics", this.zzcnv, false))
      return; 
    Method method = zzj(paramContext, "setCurrentScreen");
    try {
      Activity activity = (Activity)paramContext;
      method.invoke(this.zzcnv.get(), new Object[] { activity, paramString, paramContext.getPackageName() });
      return;
    } catch (Exception paramContext) {
      zza(paramContext, "setCurrentScreen", false);
      return;
    } 
  }
  
  public final void zze(Context paramContext, String paramString) { zza(paramContext, "_ac", paramString); }
  
  public final void zzf(Context paramContext, String paramString) { zza(paramContext, "_ai", paramString); }
  
  public final void zzg(Context paramContext, String paramString) { zza(paramContext, "_aq", paramString); }
  
  public final boolean zzs(Context paramContext) { // Byte code:
    //   0: getstatic com/google/android/gms/internal/ads/zznk.zzaxj : Lcom/google/android/gms/internal/ads/zzna;
    //   3: astore_2
    //   4: invokestatic zzik : ()Lcom/google/android/gms/internal/ads/zzni;
    //   7: aload_2
    //   8: invokevirtual zzd : (Lcom/google/android/gms/internal/ads/zzna;)Ljava/lang/Object;
    //   11: checkcast java/lang/Boolean
    //   14: invokevirtual booleanValue : ()Z
    //   17: ifeq -> 103
    //   20: aload_0
    //   21: getfield zzcns : Ljava/util/concurrent/atomic/AtomicBoolean;
    //   24: invokevirtual get : ()Z
    //   27: ifeq -> 32
    //   30: iconst_0
    //   31: ireturn
    //   32: aload_0
    //   33: getfield zzcnt : Ljava/util/concurrent/atomic/AtomicInteger;
    //   36: invokevirtual get : ()I
    //   39: iconst_m1
    //   40: if_icmpne -> 90
    //   43: invokestatic zzif : ()Lcom/google/android/gms/internal/ads/zzamu;
    //   46: pop
    //   47: aload_1
    //   48: invokestatic zzbe : (Landroid/content/Context;)Z
    //   51: ifne -> 82
    //   54: invokestatic zzif : ()Lcom/google/android/gms/internal/ads/zzamu;
    //   57: pop
    //   58: aload_1
    //   59: invokestatic zzbh : (Landroid/content/Context;)Z
    //   62: ifeq -> 82
    //   65: ldc_w 'Google Play Service is out of date, the Google Mobile Ads SDK will not integrate with Firebase. Admob/Firebase integration requires updated Google Play Service.'
    //   68: invokestatic zzdk : (Ljava/lang/String;)V
    //   71: aload_0
    //   72: getfield zzcnt : Ljava/util/concurrent/atomic/AtomicInteger;
    //   75: iconst_0
    //   76: invokevirtual set : (I)V
    //   79: goto -> 90
    //   82: aload_0
    //   83: getfield zzcnt : Ljava/util/concurrent/atomic/AtomicInteger;
    //   86: iconst_1
    //   87: invokevirtual set : (I)V
    //   90: aload_0
    //   91: getfield zzcnt : Ljava/util/concurrent/atomic/AtomicInteger;
    //   94: invokevirtual get : ()I
    //   97: iconst_1
    //   98: if_icmpne -> 103
    //   101: iconst_1
    //   102: ireturn
    //   103: iconst_0
    //   104: ireturn }
  
  public final boolean zzt(Context paramContext) {
    zzna zzna = zznk.zzaxk;
    return (((Boolean)zzkb.zzik().zzd(zzna)).booleanValue() && zzs(paramContext));
  }
  
  public final boolean zzu(Context paramContext) {
    zzna zzna = zznk.zzaxl;
    return (((Boolean)zzkb.zzik().zzd(zzna)).booleanValue() && zzs(paramContext));
  }
  
  public final boolean zzv(Context paramContext) {
    zzna zzna = zznk.zzaxm;
    return (((Boolean)zzkb.zzik().zzd(zzna)).booleanValue() && zzs(paramContext));
  }
  
  public final boolean zzw(Context paramContext) {
    zzna zzna = zznk.zzaxn;
    return (((Boolean)zzkb.zzik().zzd(zzna)).booleanValue() && zzs(paramContext));
  }
  
  public final boolean zzx(Context paramContext) {
    zzna zzna = zznk.zzaxq;
    return (((Boolean)zzkb.zzik().zzd(zzna)).booleanValue() && zzs(paramContext));
  }
  
  public final String zzy(Context paramContext) {
    if (!zzs(paramContext))
      return ""; 
    if (!zza(paramContext, "com.google.android.gms.measurement.AppMeasurement", this.zzcnu, true))
      return ""; 
    try {
      String str2 = (String)zzi(paramContext, "getCurrentScreenName").invoke(this.zzcnu.get(), new Object[0]);
      String str1 = str2;
      if (str2 == null)
        str1 = (String)zzi(paramContext, "getCurrentScreenClass").invoke(this.zzcnu.get(), new Object[0]); 
      return (str1 != null) ? str1 : "";
    } catch (Exception paramContext) {
      zza(paramContext, "getCurrentScreenName", false);
      return "";
    } 
  }
  
  @Nullable
  public final String zzz(Context paramContext) {
    if (!zzs(paramContext))
      return null; 
    synchronized (this.zzcnq) {
      if (this.zzcnr != null)
        return this.zzcnr; 
      this.zzcnr = (String)zza("getGmpAppId", null);
      return this.zzcnr;
    } 
  }
}

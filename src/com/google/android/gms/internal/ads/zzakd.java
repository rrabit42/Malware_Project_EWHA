package com.google.android.gms.internal.ads;

import android.annotation.TargetApi;
import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.security.NetworkSecurityPolicy;
import com.google.android.gms.ads.internal.zzbv;
import com.google.android.gms.common.util.PlatformVersion;
import java.util.Collections;
import java.util.Set;
import java.util.concurrent.CancellationException;
import java.util.concurrent.CopyOnWriteArraySet;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;
import javax.annotation.Nullable;
import javax.annotation.concurrent.GuardedBy;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

@zzadh
public final class zzakd {
  private final Object mLock = new Object();
  
  @Nullable
  @GuardedBy("mLock")
  private SharedPreferences zzatw;
  
  @GuardedBy("mLock")
  private boolean zzcik = true;
  
  @GuardedBy("mLock")
  private boolean zzcil = true;
  
  @GuardedBy("mLock")
  private boolean zzcim = true;
  
  @GuardedBy("mLock")
  private boolean zzcit = false;
  
  @GuardedBy("mLock")
  private String zzcpj = "";
  
  @GuardedBy("mLock")
  private int zzcqg = -1;
  
  private zzanz<?> zzcqu;
  
  private CopyOnWriteArraySet<zzakh> zzcqv = new CopyOnWriteArraySet();
  
  @Nullable
  @GuardedBy("mLock")
  SharedPreferences.Editor zzcqw;
  
  @GuardedBy("mLock")
  private boolean zzcqx = false;
  
  @Nullable
  @GuardedBy("mLock")
  private String zzcqy;
  
  @Nullable
  @GuardedBy("mLock")
  private String zzcqz;
  
  @GuardedBy("mLock")
  private long zzcra = 0L;
  
  @GuardedBy("mLock")
  private long zzcrb = 0L;
  
  @GuardedBy("mLock")
  private long zzcrc = 0L;
  
  @GuardedBy("mLock")
  private int zzcrd = 0;
  
  @GuardedBy("mLock")
  private Set<String> zzcre = Collections.emptySet();
  
  @GuardedBy("mLock")
  private JSONObject zzcrf = new JSONObject();
  
  private final void zze(Bundle paramBundle) { (new zzakf(this, paramBundle)).zznt(); }
  
  @TargetApi(23)
  private static boolean zzqq() { return (PlatformVersion.isAtLeastM() && !NetworkSecurityPolicy.getInstance().isCleartextTrafficPermitted()); }
  
  private final void zzqr() {
    zzanz1 = this.zzcqu;
    if (zzanz1 == null)
      return; 
    if (zzanz1.isDone())
      return; 
    try {
      this.zzcqu.get(1L, TimeUnit.SECONDS);
      return;
    } catch (InterruptedException zzanz1) {
      Thread.currentThread().interrupt();
      zzakb.zzc("Interrupted while waiting for preferences loaded.", zzanz1);
      return;
    } catch (CancellationException zzanz1) {
      zzakb.zzb("Fail to initialize AdSharedPreferenceManager.", zzanz1);
      return;
    } catch (ExecutionException zzanz1) {
      zzakb.zzb("Fail to initialize AdSharedPreferenceManager.", zzanz1);
      return;
    } catch (TimeoutException zzanz1) {
      zzakb.zzb("Fail to initialize AdSharedPreferenceManager.", zzanz1);
      return;
    } 
  }
  
  private final Bundle zzqs() {
    null = new Bundle();
    null.putBoolean("listener_registration_bundle", true);
    synchronized (this.mLock) {
      null.putBoolean("use_https", this.zzcik);
      null.putBoolean("content_url_opted_out", this.zzcil);
      null.putBoolean("content_vertical_opted_out", this.zzcim);
      null.putBoolean("auto_collect_location", this.zzcit);
      null.putInt("version_code", this.zzcrd);
      null.putStringArray("never_pool_slots", (String[])this.zzcre.toArray(new String[this.zzcre.size()]));
      null.putString("app_settings_json", this.zzcpj);
      null.putLong("app_settings_last_update_ms", this.zzcra);
      null.putLong("app_last_background_time_ms", this.zzcrb);
      null.putInt("request_in_session_count", this.zzcqg);
      null.putLong("first_ad_req_time_ms", this.zzcrc);
      null.putString("native_advanced_settings", this.zzcrf.toString());
      if (this.zzcqy != null)
        null.putString("content_url_hashes", this.zzcqy); 
      if (this.zzcqz != null)
        null.putString("content_vertical_hashes", this.zzcqz); 
      return null;
    } 
  }
  
  public final void initialize(Context paramContext) {
    if (paramContext.getApplicationContext() != null)
      paramContext = paramContext.getApplicationContext(); 
    this.zzcqu = (zzanz)(new zzake(this, paramContext)).zznt();
  }
  
  public final void zza(zzakh paramzzakh) {
    synchronized (this.mLock) {
      if (this.zzcqu != null && this.zzcqu.isDone())
        paramzzakh.zzd(zzqs()); 
      this.zzcqv.add(paramzzakh);
      return;
    } 
  }
  
  public final void zza(String paramString1, String paramString2, boolean paramBoolean) {
    zzqr();
    synchronized (this.mLock) {
      int j;
      JSONArray jSONArray2 = this.zzcrf.optJSONArray(paramString1);
      JSONArray jSONArray1 = jSONArray2;
      if (jSONArray2 == null)
        jSONArray1 = new JSONArray(); 
      int k = jSONArray1.length();
      int i = 0;
      while (true) {
        j = k;
        if (i < jSONArray1.length()) {
          JSONObject jSONObject = jSONArray1.optJSONObject(i);
          if (jSONObject == null)
            return; 
          if (paramString2.equals(jSONObject.optString("template_id"))) {
            if (paramBoolean == true && jSONObject.optBoolean("uses_media_view", false) == paramBoolean)
              return; 
            j = i;
            break;
          } 
          i++;
          continue;
        } 
        break;
      } 
      try {
        JSONObject jSONObject = new JSONObject();
        jSONObject.put("template_id", paramString2);
        jSONObject.put("uses_media_view", paramBoolean);
        jSONObject.put("timestamp_ms", zzbv.zzer().currentTimeMillis());
        jSONArray1.put(j, jSONObject);
        this.zzcrf.put(paramString1, jSONArray1);
      } catch (JSONException paramString1) {
        zzakb.zzc("Could not update native advanced settings", paramString1);
      } 
      if (this.zzcqw != null) {
        this.zzcqw.putString("native_advanced_settings", this.zzcrf.toString());
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putString("native_advanced_settings", this.zzcrf.toString());
      zze(bundle);
      return;
    } 
  }
  
  public final void zzab(boolean paramBoolean) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcik == paramBoolean)
        return; 
      this.zzcik = paramBoolean;
      if (this.zzcqw != null) {
        this.zzcqw.putBoolean("use_https", paramBoolean);
        this.zzcqw.apply();
      } 
      if (!this.zzcqx) {
        Bundle bundle = new Bundle();
        bundle.putBoolean("use_https", paramBoolean);
        zze(bundle);
      } 
      return;
    } 
  }
  
  public final void zzac(boolean paramBoolean) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcil == paramBoolean)
        return; 
      this.zzcil = paramBoolean;
      if (this.zzcqw != null) {
        this.zzcqw.putBoolean("content_url_opted_out", paramBoolean);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putBoolean("content_url_opted_out", this.zzcil);
      bundle.putBoolean("content_vertical_opted_out", this.zzcim);
      zze(bundle);
      return;
    } 
  }
  
  public final void zzad(boolean paramBoolean) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcim == paramBoolean)
        return; 
      this.zzcim = paramBoolean;
      if (this.zzcqw != null) {
        this.zzcqw.putBoolean("content_vertical_opted_out", paramBoolean);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putBoolean("content_url_opted_out", this.zzcil);
      bundle.putBoolean("content_vertical_opted_out", this.zzcim);
      zze(bundle);
      return;
    } 
  }
  
  public final void zzae(int paramInt) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcrd == paramInt)
        return; 
      this.zzcrd = paramInt;
      if (this.zzcqw != null) {
        this.zzcqw.putInt("version_code", paramInt);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putInt("version_code", paramInt);
      zze(bundle);
      return;
    } 
  }
  
  public final void zzae(boolean paramBoolean) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcit == paramBoolean)
        return; 
      this.zzcit = paramBoolean;
      if (this.zzcqw != null) {
        this.zzcqw.putBoolean("auto_collect_location", paramBoolean);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putBoolean("auto_collect_location", paramBoolean);
      zze(bundle);
      return;
    } 
  }
  
  public final void zzaf(int paramInt) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcqg == paramInt)
        return; 
      this.zzcqg = paramInt;
      if (this.zzcqw != null) {
        this.zzcqw.putInt("request_in_session_count", paramInt);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putInt("request_in_session_count", paramInt);
      zze(bundle);
      return;
    } 
  }
  
  public final void zzcn(@Nullable String paramString) { // Byte code:
    //   0: aload_0
    //   1: invokespecial zzqr : ()V
    //   4: aload_0
    //   5: getfield mLock : Ljava/lang/Object;
    //   8: astore_2
    //   9: aload_2
    //   10: monitorenter
    //   11: aload_1
    //   12: ifnull -> 88
    //   15: aload_1
    //   16: aload_0
    //   17: getfield zzcqy : Ljava/lang/String;
    //   20: invokevirtual equals : (Ljava/lang/Object;)Z
    //   23: ifeq -> 29
    //   26: goto -> 88
    //   29: aload_0
    //   30: aload_1
    //   31: putfield zzcqy : Ljava/lang/String;
    //   34: aload_0
    //   35: getfield zzcqw : Landroid/content/SharedPreferences$Editor;
    //   38: ifnull -> 64
    //   41: aload_0
    //   42: getfield zzcqw : Landroid/content/SharedPreferences$Editor;
    //   45: ldc_w 'content_url_hashes'
    //   48: aload_1
    //   49: invokeinterface putString : (Ljava/lang/String;Ljava/lang/String;)Landroid/content/SharedPreferences$Editor;
    //   54: pop
    //   55: aload_0
    //   56: getfield zzcqw : Landroid/content/SharedPreferences$Editor;
    //   59: invokeinterface apply : ()V
    //   64: new android/os/Bundle
    //   67: dup
    //   68: invokespecial <init> : ()V
    //   71: astore_3
    //   72: aload_3
    //   73: ldc_w 'content_url_hashes'
    //   76: aload_1
    //   77: invokevirtual putString : (Ljava/lang/String;Ljava/lang/String;)V
    //   80: aload_0
    //   81: aload_3
    //   82: invokespecial zze : (Landroid/os/Bundle;)V
    //   85: aload_2
    //   86: monitorexit
    //   87: return
    //   88: aload_2
    //   89: monitorexit
    //   90: return
    //   91: astore_1
    //   92: aload_2
    //   93: monitorexit
    //   94: aload_1
    //   95: athrow
    // Exception table:
    //   from	to	target	type
    //   15	26	91	finally
    //   29	64	91	finally
    //   64	87	91	finally
    //   88	90	91	finally
    //   92	94	91	finally }
  
  public final void zzco(@Nullable String paramString) { // Byte code:
    //   0: aload_0
    //   1: invokespecial zzqr : ()V
    //   4: aload_0
    //   5: getfield mLock : Ljava/lang/Object;
    //   8: astore_2
    //   9: aload_2
    //   10: monitorenter
    //   11: aload_1
    //   12: ifnull -> 88
    //   15: aload_1
    //   16: aload_0
    //   17: getfield zzcqz : Ljava/lang/String;
    //   20: invokevirtual equals : (Ljava/lang/Object;)Z
    //   23: ifeq -> 29
    //   26: goto -> 88
    //   29: aload_0
    //   30: aload_1
    //   31: putfield zzcqz : Ljava/lang/String;
    //   34: aload_0
    //   35: getfield zzcqw : Landroid/content/SharedPreferences$Editor;
    //   38: ifnull -> 64
    //   41: aload_0
    //   42: getfield zzcqw : Landroid/content/SharedPreferences$Editor;
    //   45: ldc_w 'content_vertical_hashes'
    //   48: aload_1
    //   49: invokeinterface putString : (Ljava/lang/String;Ljava/lang/String;)Landroid/content/SharedPreferences$Editor;
    //   54: pop
    //   55: aload_0
    //   56: getfield zzcqw : Landroid/content/SharedPreferences$Editor;
    //   59: invokeinterface apply : ()V
    //   64: new android/os/Bundle
    //   67: dup
    //   68: invokespecial <init> : ()V
    //   71: astore_3
    //   72: aload_3
    //   73: ldc_w 'content_vertical_hashes'
    //   76: aload_1
    //   77: invokevirtual putString : (Ljava/lang/String;Ljava/lang/String;)V
    //   80: aload_0
    //   81: aload_3
    //   82: invokespecial zze : (Landroid/os/Bundle;)V
    //   85: aload_2
    //   86: monitorexit
    //   87: return
    //   88: aload_2
    //   89: monitorexit
    //   90: return
    //   91: astore_1
    //   92: aload_2
    //   93: monitorexit
    //   94: aload_1
    //   95: athrow
    // Exception table:
    //   from	to	target	type
    //   15	26	91	finally
    //   29	64	91	finally
    //   64	87	91	finally
    //   88	90	91	finally
    //   92	94	91	finally }
  
  public final void zzcp(String paramString) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcre.contains(paramString))
        return; 
      this.zzcre.add(paramString);
      if (this.zzcqw != null) {
        this.zzcqw.putStringSet("never_pool_slots", this.zzcre);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putStringArray("never_pool_slots", (String[])this.zzcre.toArray(new String[this.zzcre.size()]));
      zze(bundle);
      return;
    } 
  }
  
  public final void zzcq(String paramString) {
    zzqr();
    synchronized (this.mLock) {
      if (!this.zzcre.contains(paramString))
        return; 
      this.zzcre.remove(paramString);
      if (this.zzcqw != null) {
        this.zzcqw.putStringSet("never_pool_slots", this.zzcre);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putStringArray("never_pool_slots", (String[])this.zzcre.toArray(new String[this.zzcre.size()]));
      zze(bundle);
      return;
    } 
  }
  
  public final boolean zzcr(String paramString) {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcre.contains(paramString);
    } 
  }
  
  public final void zzcs(String paramString) {
    zzqr();
    synchronized (this.mLock) {
      long l = zzbv.zzer().currentTimeMillis();
      this.zzcra = l;
      if (paramString == null || paramString.equals(this.zzcpj))
        return; 
      this.zzcpj = paramString;
      if (this.zzcqw != null) {
        this.zzcqw.putString("app_settings_json", paramString);
        this.zzcqw.putLong("app_settings_last_update_ms", l);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putString("app_settings_json", paramString);
      bundle.putLong("app_settings_last_update_ms", l);
      zze(bundle);
      return;
    } 
  }
  
  public final void zzj(long paramLong) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcrb == paramLong)
        return; 
      this.zzcrb = paramLong;
      if (this.zzcqw != null) {
        this.zzcqw.putLong("app_last_background_time_ms", paramLong);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putLong("app_last_background_time_ms", paramLong);
      zze(bundle);
      return;
    } 
  }
  
  public final void zzk(long paramLong) {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcrc == paramLong)
        return; 
      this.zzcrc = paramLong;
      if (this.zzcqw != null) {
        this.zzcqw.putLong("first_ad_req_time_ms", paramLong);
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putLong("first_ad_req_time_ms", paramLong);
      zze(bundle);
      return;
    } 
  }
  
  public final boolean zzqt() {
    zzqr();
    synchronized (this.mLock) {
      if (this.zzcik || this.zzcqx)
        return true; 
    } 
    boolean bool = false;
    /* monitor exit ClassFileLocalVariableReferenceExpression{type=ObjectType{java/lang/Object}, name=SYNTHETIC_LOCAL_VARIABLE_2} */
    return bool;
  }
  
  public final boolean zzqu() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcil;
    } 
  }
  
  @Nullable
  public final String zzqv() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcqy;
    } 
  }
  
  public final boolean zzqw() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcim;
    } 
  }
  
  @Nullable
  public final String zzqx() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcqz;
    } 
  }
  
  public final boolean zzqy() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcit;
    } 
  }
  
  public final int zzqz() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcrd;
    } 
  }
  
  public final zzajl zzra() {
    zzqr();
    synchronized (this.mLock) {
      return new zzajl(this.zzcpj, this.zzcra);
    } 
  }
  
  public final long zzrb() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcrb;
    } 
  }
  
  public final int zzrc() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcqg;
    } 
  }
  
  public final long zzrd() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcrc;
    } 
  }
  
  public final JSONObject zzre() {
    zzqr();
    synchronized (this.mLock) {
      return this.zzcrf;
    } 
  }
  
  public final void zzrf() {
    zzqr();
    synchronized (this.mLock) {
      this.zzcrf = new JSONObject();
      if (this.zzcqw != null) {
        this.zzcqw.remove("native_advanced_settings");
        this.zzcqw.apply();
      } 
      Bundle bundle = new Bundle();
      bundle.putString("native_advanced_settings", "{}");
      zze(bundle);
      return;
    } 
  }
}

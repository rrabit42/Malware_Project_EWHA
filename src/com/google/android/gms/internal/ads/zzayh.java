package com.google.android.gms.internal.ads;

import java.security.GeneralSecurityException;
import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public final class zzayh implements zzazi {
  private final SecretKeySpec zzdmu;
  
  private final int zzdmv;
  
  private final int zzdmw;
  
  public zzayh(byte[] paramArrayOfByte, int paramInt) throws GeneralSecurityException {
    this.zzdmu = new SecretKeySpec(paramArrayOfByte, "AES");
    this.zzdmw = ((Cipher)zzayy.zzdnz.zzek("AES/CTR/NoPadding")).getBlockSize();
    if (paramInt >= 12 && paramInt <= this.zzdmw) {
      this.zzdmv = paramInt;
      return;
    } 
    throw new GeneralSecurityException("invalid IV size");
  }
  
  public final byte[] zzk(byte[] paramArrayOfByte) throws GeneralSecurityException {
    int i = paramArrayOfByte.length;
    int j = this.zzdmv;
    if (i <= Integer.MAX_VALUE - j) {
      byte[] arrayOfByte1 = new byte[paramArrayOfByte.length + j];
      byte[] arrayOfByte2 = zzazl.zzbh(j);
      System.arraycopy(arrayOfByte2, 0, arrayOfByte1, 0, this.zzdmv);
      i = paramArrayOfByte.length;
      j = this.zzdmv;
      Cipher cipher = (Cipher)zzayy.zzdnz.zzek("AES/CTR/NoPadding");
      byte[] arrayOfByte3 = new byte[this.zzdmw];
      System.arraycopy(arrayOfByte2, 0, arrayOfByte3, 0, this.zzdmv);
      IvParameterSpec ivParameterSpec = new IvParameterSpec(arrayOfByte3);
      cipher.init(1, this.zzdmu, ivParameterSpec);
      if (cipher.doFinal(paramArrayOfByte, 0, i, arrayOfByte1, j) == i)
        return arrayOfByte1; 
      throw new GeneralSecurityException("stored output's length does not match input's length");
    } 
    StringBuilder stringBuilder = new StringBuilder(43);
    stringBuilder.append("plaintext length can not exceed ");
    stringBuilder.append(Integer.MAX_VALUE - j);
    throw new GeneralSecurityException(stringBuilder.toString());
  }
}

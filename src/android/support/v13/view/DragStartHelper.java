package android.support.v13.view;

import android.graphics.Point;
import android.support.v4.view.MotionEventCompat;
import android.view.MotionEvent;
import android.view.View;

public class DragStartHelper {
  private boolean mDragging;
  
  private int mLastTouchX;
  
  private int mLastTouchY;
  
  private final OnDragStartListener mListener;
  
  private final View.OnLongClickListener mLongClickListener = new Object(this);
  
  private final View.OnTouchListener mTouchListener = new Object(this);
  
  private final View mView;
  
  public DragStartHelper(View paramView, OnDragStartListener paramOnDragStartListener) {
    this.mView = paramView;
    this.mListener = paramOnDragStartListener;
  }
  
  public void attach() {
    this.mView.setOnLongClickListener(this.mLongClickListener);
    this.mView.setOnTouchListener(this.mTouchListener);
  }
  
  public void detach() {
    this.mView.setOnLongClickListener(null);
    this.mView.setOnTouchListener(null);
  }
  
  public void getTouchPosition(Point paramPoint) { paramPoint.set(this.mLastTouchX, this.mLastTouchY); }
  
  public boolean onLongClick(View paramView) { return this.mListener.onDragStart(paramView, this); }
  
  public boolean onTouch(View paramView, MotionEvent paramMotionEvent) {
    int i = (int)paramMotionEvent.getX();
    int j = (int)paramMotionEvent.getY();
    int k = paramMotionEvent.getAction();
    if (k != 0) {
      if (k != 1)
        if (k != 2) {
          if (k != 3)
            return false; 
        } else {
          if (MotionEventCompat.isFromSource(paramMotionEvent, 8194)) {
            if ((paramMotionEvent.getButtonState() & true) == 0)
              return false; 
            if (this.mDragging)
              return false; 
            if (this.mLastTouchX == i && this.mLastTouchY == j)
              return false; 
            this.mLastTouchX = i;
            this.mLastTouchY = j;
            this.mDragging = this.mListener.onDragStart(paramView, this);
            return this.mDragging;
          } 
          return false;
        }  
      this.mDragging = false;
      return false;
    } 
    this.mLastTouchX = i;
    this.mLastTouchY = j;
    return false;
  }
}
